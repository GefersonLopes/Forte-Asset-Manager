<header class="mb-6">
  <div class="flex flex-col md:flex-row items-center justify-between gap-3">
    <div class="flex items-center gap-3">
      <div
        class="flex h-12 w-12 items-center justify-center rounded-full bg-indigo-100 text-indigo-700 font-semibold"
      >
        {{ initials(employee()?.name) }}
      </div>
      <div>
        <h1 class="text-3xl font-semibold tracking-tight">
          {{ employee()?.name || 'Funcionário' }}
        </h1>
        <p class="text-sm text-gray-600">{{ employee()?.email }}</p>
      </div>
    </div>

    <button
      mat-flat-button
      color="primary"
      (click)="openAssign()"
      class="!rounded-xl px-4 py-2 flex items-center gap-2 !bg-black !text-white w-full md:w-auto"
    >
      <mat-icon fontSet="material-symbols-outlined">link</mat-icon>
      <p>Associar Ativo</p>
    </button>
  </div>
</header>

<section class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-5">
  <div class="rounded-2xl border bg-white p-4 shadow-sm">
    <div class="flex items-center justify-between">
      <span class="text-sm text-gray-600">Total de Ativos</span>
      <span class="material-symbols-outlined text-xl text-gray-500">inventory_2</span>
    </div>
    <div class="mt-2 text-3xl font-bold">{{ assets().length }}</div>
  </div>

  <div class="rounded-2xl border bg-white p-4 shadow-sm">
    <div class="flex items-center justify-between">
      <span class="text-sm text-gray-600">Ativos em uso</span>
      <span class="material-symbols-outlined text-xl text-gray-500">check_circle</span>
    </div>
    <div class="mt-2 text-3xl font-bold">{{ assets().length }}</div>
    <span
      class="mt-2 inline-flex items-center rounded-full bg-green-100 px-2 py-0.5 text-xs font-medium text-green-800"
    >
      ativos
    </span>
  </div>
</section>

@if (!loading() && assets().length === 0) {
  <div class="rounded-2xl border bg-white p-8 text-center text-gray-600">
    <div class="mb-2 flex justify-center">
      <span class="material-symbols-outlined text-5xl text-gray-400">inventory_2</span>
    </div>
    Nenhum ativo associado a este funcionário.
  </div>
}

<section class="grid gap-4 md:grid-cols-2">
  @if (loading()) {
    <ng-container>
      @for (s of [1, 2, 3, 4]; track s) {
        <article class="rounded-2xl border bg-white p-4 shadow-sm animate-pulse">
          <div class="h-4 w-1/3 bg-gray-200 rounded mb-2"></div>
          <div class="h-3 w-1/2 bg-gray-200 rounded mb-4"></div>
          <div class="h-8 w-28 bg-gray-200 rounded"></div>
        </article>
      }
    </ng-container>
  }

  @for (a of assets(); track a.id) {
    <article class="rounded-2xl border bg-white p-4 shadow-sm">
      <div class="flex items-start justify-between">
        <div>
          <h3 class="text-base font-semibold leading-tight">{{ a.name }}</h3>
          <div class="mt-1 flex flex-wrap items-center gap-2 text-sm text-gray-700">
            <span
              class="inline-flex items-center gap-1 rounded-full bg-purple-100 px-2 py-0.5 text-xs font-medium text-purple-800"
            >
              <span class="material-symbols-outlined text-base">category</span>{{ a.type }}
            </span>
            <span
              class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-xs font-medium"
              [ngClass]="{
                'bg-green-100 text-green-800': a.status === 'EmUso' || a.status === 'Disponivel',
                'bg-amber-100 text-amber-800': a.status === 'EmManutencao',
                'bg-red-100 text-red-800':
                  a.status !== 'EmUso' && a.status !== 'Disponivel' && a.status !== 'EmManutencao',
              }"
            >
              <span class="material-symbols-outlined text-base">verified</span>{{ a.status }}
            </span>
          </div>
        </div>

        <button
          mat-stroked-button
          color="warn"
          class="!rounded-xl px-4 py-2 flex items-center gap-2 !bg-gray-500 !text-white"
          (click)="unassign(a.id)"
        >
          Desassociar
        </button>
      </div>
    </article>
  }
</section>
